<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BUSGI: Synthetic Bio-Molecular Neural Interfaces | Grably Data Labs</title>

    <!-- Scripts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                tags: 'ams'
            },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap');

        :root {
            --emerald: #10b981;
            --indigo: #6366f1;
            --zinc-950: #09090b;
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--zinc-950);
            color: #fafafa;
            margin: 0;
            overflow-x: hidden;
        }

        .mono {
            font-family: 'JetBrains Mono', monospace;
        }

        .glass-panel {
            background: rgba(15, 15, 20, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 1.5rem;
        }

        .gradient-text {
            background: linear-gradient(135deg, #10b981 0%, #34d399 50%, #6366f1 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            padding-right: 0.15em;
            /* Fix for italic clipping of 'L' */
        }

        .hero-title {
            font-size: clamp(2.2rem, 6vw, 4.8rem);
            line-height: 1.1;
            letter-spacing: -0.04em;
            font-weight: 800;
            padding-bottom: 0.2em;
        }

        .btn-ping {
            background: var(--emerald);
            color: black;
            font-weight: 800;
            padding: 1.25rem 3rem;
            border-radius: 1.25rem;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.3);
            cursor: pointer;
            border: none;
        }

        .btn-ping:hover {
            transform: scale(1.05) translateY(-4px);
            box-shadow: 0 20px 40px rgba(16, 185, 129, 0.5);
        }

        .math-block {
            background: #000;
            padding: 1.5rem;
            border-radius: 1rem;
            border: 1px solid rgba(16, 185, 129, 0.2);
            margin: 1.5rem 0;
            overflow-x: auto;
            font-size: 0.95rem;
        }

        .roadmap-dot {
            position: absolute;
            left: -33px;
            top: 6px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: var(--emerald);
            border: 3px solid var(--zinc-950);
            box-shadow: 0 0 10px var(--emerald);
        }

        .nav-link {
            font-size: 0.7rem;
            font-weight: 800;
            letter-spacing: 0.15em;
            color: #71717a;
            text-transform: uppercase;
            transition: all 0.3s;
        }

        .nav-link:hover {
            color: var(--emerald);
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--zinc-950);
        }

        ::-webkit-scrollbar-thumb {
            background: #27272a;
            border-radius: 10px;
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }

        th {
            text-align: left;
            padding: 1rem;
            color: var(--emerald);
            border-bottom: 2px solid #27272a;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid #18181b;
            color: #a1a1aa;
        }

        tr:hover td {
            background: rgba(255, 255, 255, 0.02);
            color: #fff;
        }
    </style>

    <!-- Chosen Palette: Emerald & Zinc. High-tech, dark, medical dashboard aesthetic. -->

    <!-- Application Structure Plan:
         1. Hero Section: Formal Title & Abstract based on Anton Vice et al. 2026.
         2. Problem Space: Bio-mechanical limits and Equation 1.
         3. Substrate Comparison: Optimization logic, formulas 2-4, and Table 1.
         4. Energy Trade-space: Ultrasound vs Optical with formulas 5-6.
         5. The Simulation: High-fidelity anatomical neural chain.
         6. Logic Gating: Equation 7 and truth table context.
         7. ARGs & AI Pipeline: Formula 8 and workflow.
         8. Bibliography: Expandable academic references.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>

<body class="antialiased selection:bg-emerald-500 selection:text-black">

    <!-- Header Navigation -->
    <nav class="sticky top-0 z-50 bg-black/80 backdrop-blur-xl border-b border-white/5">
        <div class="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <div
                    class="w-10 h-10 bg-gradient-to-br from-emerald-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg shadow-emerald-500/30">
                    <span class="text-white font-extrabold italic text-xl">G</span>
                </div>
                <div>
                    <h2 class="text-white font-bold leading-none tracking-tight">GRABLY <span
                            class="text-emerald-500">DATA LABS</span></h2>
                    <p class="text-[9px] mono text-zinc-500 uppercase tracking-widest mt-1">Anton Vice</p>
                </div>
            </div>
            <div class="hidden lg:flex gap-10">
                <a href="#abstract" class="nav-link">Abstract</a>
                <a href="#logic" class="nav-link">Theory</a>
                <a href="#simulation" class="nav-link">Simulator</a>
                <a href="#roadmap" class="nav-link">Roadmap</a>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-6 pb-20">

        <!-- Hero Section -->
        <section id="abstract" class="py-24 lg:py-32 space-y-10">
            <div class="max-w-5xl space-y-8">
                <div
                    class="inline-flex items-center gap-2 px-3 py-1 bg-emerald-500/10 border border-emerald-500/20 rounded-full">
                    <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                    <span class="text-[10px] font-bold text-emerald-500 uppercase tracking-widest">Pre-Print //
                        GDL-2026-ARX</span>
                </div>
                <h1 class="hero-title">
                    Synthetic Bio-Molecular <br>
                    <span class="gradient-text italic">Neural Interfaces</span>
                </h1>
                <p class="text-xl md:text-2xl text-zinc-400 font-light leading-relaxed max-w-4xl">
                    Logic-Gated Protein Mini-Antennas for Ultrasound-Addressable Neuromodulation and Readout. A
                    framework for biologically integrated, genetically encodable sensing and actuation modules.
                </p>
                <div class="flex items-center gap-6 text-sm mono text-zinc-500">
                    <div>Author: <span class="text-white">Anton Vice et al.</span></div>
                    <div>Date: <span class="text-white">January 18, 2026</span></div>
                </div>
            </div>

            <!-- Abstract Paragraph -->
            <div class="glass-panel p-10 mt-12 border-white/5 shadow-2xl">
                <h3 class="text-emerald-500 font-bold uppercase tracking-widest text-xs mb-4">Abstract Overview</h3>
                <p class="text-zinc-400 leading-relaxed text-lg">
                    Implantable neural interfaces face chronic limits arising from mechanical mismatch and foreign-body
                    response. We propose a framework for genetically encodable “mini-antenna” modules that sense
                    molecular context using engineered switches, actuate neural activity via ultrasound-responsive
                    mediators, and report cellular state using acoustic contrast mechanisms. We formalize a logic-gated
                    control concept enabling cell-type and context-dependent neuromodulation.
                </p>
            </div>
        </section>

        <!-- Mechanical Limits & Substrate Optimization -->
        <section class="py-20 grid grid-cols-1 lg:grid-cols-2 gap-16">
            <div class="space-y-8">
                <h3 class="text-3xl font-extrabold text-white">Bio-mechanical <span
                        class="text-emerald-500 italic">Limits</span></h3>
                <p class="text-zinc-400 leading-relaxed">
                    Chronic implants trigger glial responses that increase access impedance. A Randles-type circuit with
                    a constant phase element (CPE) describes this interfacial behavior:
                </p>
                <div class="math-block">
                    $$ Z(\omega)=R_s+\left(\frac{1}{\frac{1}{R_{ct}}+Q(j\omega)^{\alpha}}\right) \tag{1} $$
                </div>
                <p class="text-zinc-500 text-sm">
                    Access impedance $Z$ shifts as encapsulation chemistry evolves, motivating biological
                    components—engineered proteins—rather than rigid inorganic interfaces.
                </p>
            </div>

            <div class="space-y-8">
                <h3 class="text-3xl font-extrabold text-white">Substrate <span
                        class="text-emerald-500 italic">Optimization</span></h3>
                <p class="text-zinc-400 leading-relaxed">
                    Small-molecule voltage indicators achieve fast responses but lack genetic specificity. Fluorescent
                    shifts are driven by electrochromic (Stark) response:
                </p>
                <div class="math-block">
                    $$ \Delta \nu \propto -\Delta\mu\cdot E - \frac{1}{2}\Delta\alpha E^2 \tag{2} $$
                </div>
                <p class="text-zinc-400 leading-relaxed">
                    In contrast, de novo protein switches like LOCKR enable Boolean logic through two-state
                    conformational gating:
                </p>
                <div class="math-block">
                    $$ K_{\mathrm{open}}=\frac{[S_{\mathrm{open}}]}{[S_{\mathrm{closed}}]}=e^{-\Delta
                    G_{\mathrm{open}}/RT} \tag{4} $$
                </div>
            </div>
        </section>

        <!-- Table 1 Implementation -->
        <section class="py-20">
            <div class="glass-panel p-8 border-white/5 overflow-x-auto">
                <h4 class="text-emerald-500 font-bold uppercase tracking-widest text-xs mb-6">Table 1. Candidate
                    Molecular Substrates</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Substrate Type</th>
                            <th>Logic Complexity</th>
                            <th>Targeting Precision</th>
                            <th>Typical Readout</th>
                            <th>CNS Compatibility</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="font-bold text-white">Engineered Proteins</td>
                            <td>High (Modular)</td>
                            <td>High (Genetic)</td>
                            <td>Optical / Acoustic</td>
                            <td>High (Biodegradable)</td>
                        </tr>
                        <tr>
                            <td class="font-bold text-white">Synthetic Chemicals</td>
                            <td>Moderate</td>
                            <td>Low–Moderate</td>
                            <td>Optical</td>
                            <td>Variable (Toxicity)</td>
                        </tr>
                        <tr>
                            <td class="font-bold text-white">DNA Circuits</td>
                            <td>Very High</td>
                            <td>Moderate–High</td>
                            <td>FRET</td>
                            <td>Moderate (Degradation)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Neural Chain Simulation Engine -->
        <section id="simulation" class="py-20 space-y-8">
            <div class="flex flex-col md:flex-row justify-between items-end gap-6">
                <div>
                    <h2 class="text-4xl font-extrabold text-white">Synaptic <span
                            class="text-emerald-500 italic">Chain</span> Engine</h2>
                    <p class="text-zinc-500 mt-2">Observing bio-anatomical neuron chains with clustered neurotransmitter
                        logic overrides.</p>
                </div>
                <button onclick="pingGate()" class="btn-ping">Ping EITHER Gate</button>
            </div>

            <div class="glass-panel overflow-hidden h-[650px] relative bg-black border border-white/5 shadow-inner">
                <canvas id="neuronCanvas" class="w-full h-full"></canvas>

                <!-- HUD Telemetry -->
                <div class="absolute top-8 left-8 space-y-4 pointer-events-none">
                    <div class="glass-panel p-6 space-y-3 w-64 bg-black/80 border-emerald-500/20 shadow-2xl">
                        <div class="flex justify-between items-center border-b border-white/10 pb-2 mb-2">
                            <span class="text-[9px] font-black uppercase text-zinc-500 tracking-widest">Engine
                                Status</span>
                            <span id="sys-status" class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
                        </div>
                        <div class="flex justify-between text-xs font-medium">
                            <span class="text-zinc-500 font-bold uppercase">Natural Wave:</span>
                            <span id="auto-timer" class="mono text-white">5.0s</span>
                        </div>
                        <div class="flex justify-between text-xs font-medium">
                            <span class="text-zinc-500 font-bold uppercase">Interface Logic:</span>
                            <span id="gate-status" class="mono text-emerald-500">STANDBY</span>
                        </div>
                        <div class="flex justify-between text-xs font-medium">
                            <span class="text-zinc-500 font-bold uppercase">Cleft Saturation:</span>
                            <span class="mono text-indigo-400">88.4%</span>
                        </div>
                    </div>
                </div>

                <!-- Simulation Footer Info -->
                <div
                    class="absolute bottom-8 right-8 bg-black/60 p-4 rounded-xl text-[9px] mono text-zinc-500 uppercase tracking-widest border border-white/5">
                    Synthetic Overrides: <span class="text-emerald-500 font-bold">EMERALD</span> // Autonomous Pulse:
                    <span class="text-white font-bold">WHITE</span>
                </div>
            </div>
        </section>

        <!-- Acoustic Trade-space & Logic Architecture -->
        <section id="logic" class="py-20 grid grid-cols-1 lg:grid-cols-2 gap-16">
            <div class="space-y-12">
                <div class="space-y-4">
                    <h3 class="text-3xl font-extrabold text-white">Acoustic <span
                            class="text-indigo-400 italic">Trade-space</span></h3>
                    <p class="text-zinc-400 leading-relaxed">
                        Ultrasound provides a practical compromise between penetration and focality. Simple amplitude
                        attenuation follows:
                    </p>
                    <div class="math-block">
                        $$ P(z)=P_0 e^{-\alpha(f)z} \tag{6} $$
                    </div>
                </div>

                <div class="glass-panel p-8 bg-black/40 border-white/5">
                    <h4 class="text-xs font-bold text-zinc-500 uppercase mb-8 text-center tracking-widest">Comparative
                        Modality Efficacy</h4>
                    <div class="chart-container">
                        <canvas id="modalityChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="space-y-10">
                <h3 class="text-3xl font-extrabold text-white">Logic-Gated <span
                        class="text-emerald-500 italic">Architecture</span></h3>
                <p class="text-zinc-400 leading-relaxed">
                    A minimal AND-gate concept: Ligand binding shifts a protein switch into a permissive state; Focused
                    Ultrasound (FUS) provides the second mechanical input.
                </p>
                <div class="math-block">
                    $$ P_{\mathrm{act}}([NT],P_{US}) = \underbrace{\frac{[NT]^n}{K_d^n+[NT]^n}}_{\text{biochemical}}
                    \cdot \underbrace{G(P_{US})}_{\text{ultrasound}} \tag{7} $$
                </div>
                <p class="text-zinc-500 text-sm italic">
                    Reporting neural state via Rayleigh scattering in Rayleigh GVs:
                </p>
                <div class="math-block">
                    $$ \sigma \propto k^4 a^6 \left|\Delta \chi\right|^2 \tag{8} $$
                </div>
            </div>
        </section>

        <!-- Roadmap & Experimental Milestones -->
        <section id="roadmap" class="py-20 space-y-12">
            <h3 class="text-4xl font-extrabold text-white italic">Research Roadmap</h3>
            <div class="relative ml-10 space-y-16 pl-10 border-l-2 border-zinc-900">
                <div class="relative">
                    <div class="roadmap-dot"></div>
                    <h4 class="font-bold text-xl text-white">Milestone A: In Vitro Validation</h4>
                    <p class="text-sm text-zinc-500 mt-2">Demonstrate biochemical gating of ultrasound responsiveness in
                        cultured neurons with stringent thermal and cavitation controls.</p>
                </div>
                <div class="relative">
                    <div class="roadmap-dot" style="background: var(--indigo); box-shadow: 0 0 10px var(--indigo);">
                    </div>
                    <h4 class="font-bold text-xl text-white">Milestone B: Small Animal Efficacy</h4>
                    <p class="text-sm text-zinc-500 mt-2">Cell-type-specific modulation with behavioral readouts;
                        quantifying exposure margins and safety endpoints.</p>
                </div>
                <div class="relative">
                    <div class="roadmap-dot" style="background: #52525b; box-shadow: none;"></div>
                    <h4 class="font-bold text-xl text-zinc-400 italic">Milestone C: Readout Integration</h4>
                    <p class="text-sm text-zinc-600 mt-2 italic">Co-express ARGs (Acoustic Reporter Genes) with
                        actuation modules to establish non-invasive sensitivity limits.</p>
                </div>
            </div>
        </section>

        <!-- References Section -->
        <section class="py-20 border-t border-white/5">
            <details class="group glass-panel border-white/5 overflow-hidden">
                <summary
                    class="p-8 cursor-pointer flex justify-between items-center hover:bg-white/5 transition-colors">
                    <h3 class="text-2xl font-bold text-white italic">Bibliography <span
                            class="text-zinc-600">GDL-R-09</span></h3>
                    <div
                        class="w-10 h-10 rounded-full border border-white/10 flex items-center justify-center group-open:rotate-180 transition-transform">
                        <svg class="w-5 h-5" fill="none" stroke="white" viewBox="0 0 24 24">
                            <path d="M19 9l-7 7-7-7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            </path>
                        </svg>
                    </div>
                </summary>
                <div class="p-10 pt-0 space-y-4 mono text-[10px] text-zinc-500 uppercase tracking-widest leading-loose">
                    <p>[1] Salatino JW et al. *Glial responses to implanted electrodes in the brain.* Nat Biomed Eng.
                        2017.</p>
                    <p>[2] Campbell A et al. *Chronically implanted intracranial electrodes: tissue response over time.*
                        Micromachines. 2018.</p>
                    <p>[3] Chen Z et al. *De novo design of protein logic gates.* Science. 2020.</p>
                    <p>[4] Naor O et al. *The biophysical mechanisms of ultrasound neuromodulation.* Nat Rev Neurosci.
                        2016.</p>
                    <p>[5] Farhadi A et al. *Ultrasound imaging of gene expression in mammalian cells.* Science. 2019.
                    </p>
                    <p>[6] Bourdeau RW et al. *Acoustic reporter genes for noninvasive imaging.* Nature. 2018.</p>
                    <p>[7] Abramson J et al. *Structure prediction of biomolecular interactions with AlphaFold 3.*
                        Nature. 2024.</p>
                </div>
            </details>
        </section>

    </main>

    <footer class="border-t border-white/5 py-16 bg-black">
        <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center gap-10">
            <div class="flex items-center gap-4 text-zinc-600 mono text-[9px] uppercase tracking-widest">
                <span>© 2026 GRABLY DATA LABS</span>
                <span class="w-1 h-1 rounded-full bg-zinc-800"></span>
                <span>Anton Vice</span>
            </div>
            <div class="flex gap-10 text-[10px] font-bold text-zinc-700 uppercase tracking-widest">
                <a href="#" class="hover:text-emerald-500 transition-colors">Research PDF</a>
                <a href="#" class="hover:text-emerald-500 transition-colors">Lab Contact</a>
            </div>
        </div>
    </footer>

    <script>
        // --- Simulation State ---
        const config = {
            neuronCount: 7,
            autoInterval: 5000,
            pulseSpeed: 0.02,
            particleDensity: 20
        };

        const state = {
            neurons: [],
            pulses: [],
            particles: [],
            lastAutoPulse: Date.now(),
            canvasWidth: 0,
            canvasHeight: 0
        };

        const canvas = document.getElementById('neuronCanvas');
        const ctx = canvas.getContext('2d');

        // --- Anatomical Renderer ---
        function drawAnatomicalNeuron(x, y, isSynthetic, isActive) {
            ctx.save();
            ctx.translate(x, y);

            const color = isActive ? (isSynthetic ? "#10b981" : "#fff") : "#1c1c1f";
            const glow = isActive ? (isSynthetic ? "#34d399" : "#a1a1aa") : "#09090b";

            // Dendrite Arbor (Inputs)
            ctx.strokeStyle = color;
            ctx.lineWidth = 1.2;
            for (let i = 0; i < 8; i++) {
                const angle = (i * Math.PI * 2) / 8 + Math.sin(Date.now() * 0.001 + i) * 0.15;
                ctx.beginPath();
                ctx.moveTo(0, 0);
                const cp1x = Math.cos(angle) * 18;
                const cp1y = Math.sin(angle) * 18;
                const endX = Math.cos(angle) * 40;
                const endY = Math.sin(angle) * 40;
                ctx.quadraticCurveTo(cp1x, cp1y, endX, endY);
                ctx.stroke();

                // Secondary branching
                ctx.beginPath();
                ctx.moveTo(cp1x, cp1y);
                ctx.lineTo(cp1x + Math.cos(angle + 0.6) * 12, cp1y + Math.sin(angle + 0.6) * 12);
                ctx.stroke();
            }

            // Soma (Body)
            const somaGrad = ctx.createRadialGradient(0, 0, 0, 0, 0, 15);
            somaGrad.addColorStop(0, isActive ? color : "#18181b");
            somaGrad.addColorStop(1, glow);

            ctx.fillStyle = somaGrad;
            ctx.shadowBlur = isActive ? 40 : 0;
            ctx.shadowColor = isSynthetic ? "#10b981" : "#fff";
            ctx.beginPath();
            ctx.arc(0, 0, 13, 0, Math.PI * 2);
            ctx.fill();

            // Nucleus
            ctx.fillStyle = "rgba(0,0,0,0.6)";
            ctx.beginPath();
            ctx.arc(0, 0, 4, 0, Math.PI * 2);
            ctx.fill();

            // Mini-Antenna (Synthetic)
            if (isSynthetic) {
                ctx.strokeStyle = isActive ? "#fff" : "#10b981";
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(0, -13);
                ctx.lineTo(0, -35);
                ctx.stroke();

                ctx.fillStyle = isActive ? "#fff" : "#10b981";
                ctx.beginPath();
                ctx.arc(0, -35, 5, 0, Math.PI * 2);
                ctx.fill();
            }

            ctx.restore();
        }

        // --- Interaction Logic ---
        function pingGate() {
            triggerPulse(true);
            const status = document.getElementById('gate-status');
            status.innerText = "OVERRIDE ACTIVE";
            status.className = "mono text-white animate-pulse";
            setTimeout(() => {
                status.innerText = "STANDBY";
                status.className = "mono text-emerald-500";
            }, 2000);
        }

        function triggerPulse(isSynthetic = false) {
            state.pulses.push({
                idx: 0,
                progress: 0,
                synthetic: isSynthetic
            });
            if (!isSynthetic) state.lastAutoPulse = Date.now();
        }

        // --- Engine Loop ---
        function initSim() {
            const container = canvas.parentElement;
            const dpr = window.devicePixelRatio || 1;
            canvas.width = container.clientWidth * dpr;
            canvas.height = container.clientHeight * dpr;
            ctx.scale(dpr, dpr);

            state.canvasWidth = container.clientWidth;
            state.canvasHeight = container.clientHeight;

            state.neurons = [];
            const spacing = state.canvasWidth / (config.neuronCount + 1);
            for (let i = 0; i < config.neuronCount; i++) {
                state.neurons.push({
                    x: spacing * (i + 1),
                    y: state.canvasHeight / 2 + (Math.random() - 0.5) * 100,
                    isSynthetic: i % 2 !== 0,
                    pingScale: 0
                });
            }

            // Synaptic Clusters (Particles)
            state.particles = [];
            for (let i = 0; i < config.neuronCount - 1; i++) {
                const n1 = state.neurons[i];
                const n2 = state.neurons[i + 1];
                const synX = n1.x + (n2.x - n1.x) * 0.94;
                const synY = n1.y + (n2.y - n1.y) * 0.94;

                for (let j = 0; j < config.particleDensity; j++) {
                    state.particles.push({
                        x: synX + (Math.random() - 0.5) * 40,
                        y: synY + (Math.random() - 0.5) * 40,
                        originX: synX,
                        originY: synY,
                        vx: (Math.random() - 0.5) * 0.25,
                        vy: (Math.random() - 0.5) * 0.25
                    });
                }
            }
        }

        function drawLoop() {
            ctx.fillStyle = "#050505";
            ctx.fillRect(0, 0, state.canvasWidth, state.canvasHeight);

            const now = Date.now();
            const timer = Math.max(0, (config.autoInterval - (now - state.lastAutoPulse)) / 1000).toFixed(1);
            document.getElementById('auto-timer').innerText = timer + 's';

            if (now - state.lastAutoPulse > config.autoInterval) triggerPulse(false);

            // Axon Paths
            ctx.setLineDash([8, 4]);
            ctx.strokeStyle = "rgba(255,255,255,0.015)";
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(state.neurons[0].x, state.neurons[0].y);
            state.neurons.forEach(n => ctx.lineTo(n.x, n.y));
            ctx.stroke();
            ctx.setLineDash([]);

            // Clustered Particles (NT Ligand)
            state.particles.forEach(p => {
                p.x += p.vx; p.y += p.vy;
                const dist = Math.sqrt((p.x - p.originX) ** 2 + (p.y - p.originY) ** 2);
                if (dist > 25) {
                    p.vx += (p.originX - p.x) * 0.002;
                    p.vy += (p.originY - p.y) * 0.002;
                }
                ctx.fillStyle = "rgba(99, 102, 241, 0.5)";
                ctx.beginPath(); ctx.arc(p.x, p.y, 1.4, 0, Math.PI * 2); ctx.fill();
            });

            // Pulse Propagation
            state.pulses.forEach((p, idx) => {
                p.progress += config.pulseSpeed;
                if (p.progress >= 1) {
                    p.idx++;
                    p.progress = 0;
                }
                if (p.idx >= state.neurons.length - 1) {
                    state.pulses.splice(idx, 1);
                    return;
                }

                const n1 = state.neurons[p.idx];
                const n2 = state.neurons[p.idx + 1];
                const px = n1.x + (n2.x - n1.x) * p.progress;
                const py = n1.y + (n2.y - n1.y) * p.progress;

                ctx.shadowBlur = p.synthetic ? 30 : 0;
                ctx.shadowColor = "#10b981";
                ctx.strokeStyle = p.synthetic ? "#10b981" : "#fff";
                ctx.lineWidth = 6;
                ctx.beginPath(); ctx.arc(px, py, 8, 0, Math.PI * 2); ctx.stroke();
                ctx.shadowBlur = 0;
            });

            // Anatomical Neurons
            state.neurons.forEach((n, idx) => {
                const isActive = state.pulses.some(p => p.idx === idx && p.progress < 0.25);

                // Acoustic Backscatter Reporting
                if (n.isSynthetic) {
                    if (Math.random() > 0.985) n.pingScale = 1;
                    if (n.pingScale > 0) {
                        ctx.strokeStyle = `rgba(255,255,255,${n.pingScale * 0.4})`;
                        ctx.lineWidth = 1;
                        ctx.beginPath(); ctx.arc(n.x, n.y, 10 + (1 - n.pingScale) * 60, 0, Math.PI * 2); ctx.stroke();
                        n.pingScale -= 0.012;
                    }
                }
                drawAnatomicalNeuron(n.x, n.y, n.isSynthetic, isActive);
            });

            requestAnimationFrame(drawLoop);
        }

        // --- Modality Chart ---
        function initCharts() {
            const ctxChart = document.getElementById('modalityChart').getContext('2d');
            new Chart(ctxChart, {
                type: 'radar',
                data: {
                    labels: ['Non-Invasiveness', 'Resolution', 'Depth', 'Biocompatibility', 'Safety'],
                    datasets: [{
                        label: 'BUSGI Ultrasound',
                        data: [98, 92, 98, 85, 95],
                        backgroundColor: 'rgba(16, 185, 129, 0.1)',
                        borderColor: '#10b981',
                        borderWidth: 2,
                        pointBackgroundColor: '#10b981'
                    }, {
                        label: 'Electrode Array',
                        data: [20, 96, 95, 40, 65],
                        backgroundColor: 'rgba(99, 102, 241, 0.1)',
                        borderColor: '#6366f1',
                        borderWidth: 2,
                        pointBackgroundColor: '#6366f1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: 'rgba(255,255,255,0.05)' },
                            grid: { color: 'rgba(255,255,255,0.05)' },
                            pointLabels: { color: '#52525b', font: { family: 'Plus Jakarta Sans', size: 10, weight: '700' } },
                            ticks: { display: false }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        window.onload = () => {
            initSim();
            drawLoop();
            initCharts();
        };

        window.addEventListener('resize', initSim);

    </script>
</body>

</html>